<!-- ===== FILE: index.html ===== -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Rhythm Jump Rope — iPad Web Game</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <svg width="28" height="28" viewBox="0 0 48 48" fill="none" aria-hidden="true">
          <circle cx="24" cy="24" r="22" stroke="#7cf4d3" stroke-width="2"/>
          <path d="M8 28c4-2 10-2 16-2s12 0 16 2" stroke="#f5e27a" stroke-width="3" stroke-linecap="round"/>
          <circle cx="24" cy="16" r="4" fill="#e6e8ff"/>
        </svg>
        <div>
          <h1>Rhythm Jump Rope</h1>
          <div class="tag">iPad向け リズムなわとび練習</div>
        </div>
      </div>
      <div class="controls" role="group" aria-label="ゲーム設定">
        <div class="ctrl" title="テンポ（BPM）">
          <label for="bpm">BPM</label>
          <input id="bpm" type="range" min="60" max="160" value="100" step="1" />
          <span id="bpmVal" aria-live="polite">100</span>
        </div>
        <div class="ctrl" title="難易度（判定幅）">
          <label>難易度</label>
          <div class="seg" role="tablist" aria-label="難易度">
            <button id="easy" class="active" role="tab" aria-selected="true">やさしい</button>
            <button id="normal" role="tab" aria-selected="false">ふつう</button>
            <button id="hard" role="tab" aria-selected="false">むずかしい</button>
          </div>
        </div>
        <div class="ctrl" title="サウンド">
          <label>音</label>
          <div class="seg" role="tablist" aria-label="サウンド">
            <button id="sndOn" class="active" aria-selected="true">ON</button>
            <button id="sndOff" aria-selected="false">OFF</button>
          </div>
        </div>
        <div class="ctrl" title="学習カードの表示">
          <label>学習</label>
          <div class="seg" role="tablist" aria-label="学習カード">
            <button id="statsOn" class="active" aria-selected="true">ON</button>
            <button id="statsOff" aria-selected="false">OFF</button>
          </div>
        </div>
        <button id="calibBtn" class="btn" title="タップと音のズレを補正">キャリブレーション</button>
      </div>
    </header>

    <main>
      <div class="hud">
        <div class="pill">連続ジャンプ: <span id="combo">0</span></div>
        <div class="pill">ベスト: <span id="best">0</span></div>
        <div class="pill">判定: <span id="judge">-</span></div>
      </div>

      <div id="learnCard" class="learn-card" aria-live="polite">
        <div class="row">
          <div class="kpi"><span class="label">平均ズレ</span><span id="avgDelta" class="val">- ms</span></div>
          <div class="kpi"><span class="label">テンポ維持率</span><span id="tempoRate" class="val">- %</span></div>
          <div class="kpi"><span class="label">サンプル</span><span id="sampleCount" class="val">0 / 20</span></div>
        </div>
        <div class="hint">※直近20回の結果から計算。テンポ維持率は PERFECT+GREAT の割合。</div>
      </div>

      <div class="stage">
        <canvas id="cv" aria-label="プレイエリア" role="img"></canvas>
        <div id="overlay" class="overlay" style="display:flex">
          <div class="card">
            <h2>タップして開始</h2>
            <p>音を鳴らすために、最初に画面をタップしてください。（iOSの仕様）</p>
            <div class="actions">
              <button id="startBtn" class="btn primary">プレイ開始</button>
              <button id="howBtn" class="btn">あそびかた</button>
            </div>
            <div style="margin-top:8px; font-size:12px; color:var(--muted)"> anywhereをタップしてもOK / Spaceキーでもジャンプ（外付けキーボード）</div>
          </div>
        </div>
      </div>
    </main>

    <div class="bottombar">
      <button id="jumpBtn" class="big" aria-label="ジャンプ">
        ジャンプ / Tap Anywhere
      </button>
      <button id="pauseBtn" class="big ghost" aria-label="一時停止">一時停止</button>
      <button id="resetBtn" class="big ghost" aria-label="リセット">リセット</button>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="assertive"></div>

  <script type="module" src="js/app.js"></script>
</body>
</html>
